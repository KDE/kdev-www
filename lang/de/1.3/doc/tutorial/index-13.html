<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>KDE Anwendungs Tutorials: Hinzufügen der Druckerfunktionalität</TITLE>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="keywords" CONTENT="">
<META NAME="description" CONTENT="">
</HEAD>
<BODY BGCOLOR="#ffffff" LINK="#aa0000" TEXT="#000000" > 
<FONT FACE="Helvetica">
<A HREF="http://www.kde.org/"><IMG SRC="logotp3.png" BORDER="0" ALT="The K Desktop Environment"></A>
<HR WIDTH="100%" SIZE=2 ALIGN="CENTER" NOSHADE>

 
<P ALIGN="RIGHT">

<A HREF="index-14.html">Weiter</A>
 <A HREF="index-12.html">Zurück</A>
 <A HREF="index.html#toc13">Inhaltsverzeichnis</A>
</P>
<H3><A NAME="s13">13. Hinzufügen der Druckerfunktionalität</A></H3>

<P>
<P>In diesem Kapitel werden wir Ihnen zeigen, wie einfach es ist, Druckerfunktionen mit Qt zu implementieren. Tatsächlich ist es 
nur eine Zeile Code, die wir schreiben müssen, aber wir werden verstehen, wer den Druckauftrag eigentlich ausführt. Wenn der 
Benutzer den "Drucken" Knopf in <EM>KScribble</EM> benutzt oder "Drucken" aus dem Dateimenü wählt, wird die <CODE>slotFilePrint()</CODE> 
Methode in <CODE>KScribbleApp</CODE> aufgerufen. Diese Methode prüft, welches Kindfenster gerade aktiv ist und erzeugt eine Instanz 
der Druckerklasse <CODE>QPrinter</CODE>. Dann ruft sie die Druckmethode des Widgets auf, nämlich <CODE>KScribbleView::print()</CODE>. Das 
Framework enthält bereits die Basisimplementation- was zeigt, daß Sie zum Drucken nur die Klasse <CODE>QPainter</CODE> verwenden 
müssen, die dann auf dem Drucker ausgibt. Diese Klasse ruft auch den Druckdialog auf.
<P>Was wir hier tun müssen, ist <CODE>QPainter</CODE> Methoden zu benutzen, um das Pixmap des Dokuments zu drucken, das mit der Ansicht 
verbunden ist. Da <CODE>QPainter</CODE> bereits einen Satz an <CODE>drawPixmap()</CODE> Methoden anbietet, werden wir natürlich eine davon 
benutzen: 
<P>
<HR>
<PRE>
void KScribbleView::print(QPrinter *pPrinter)
{
  if (pPrinter->setup(this))
  {
    QPainter p;
    p.begin(pPrinter);
                
    ///////////////////////////////
    // TODO: add your printing code here
->      p.drawPixmap(0,0,doc->buffer);
    ///////////////////////////////
    p.end();
  }
}
</PRE>
<HR>
<P>Hier drucken wir unser gepuffertes Pixmap des Dokuments in den Offset 0,0 der Druckerseite. Das ist alles!
<P>Sie können es einfach einmal ausprobieren- Sie können nun jede Grafik drucken, die <EM>KScribble</EM> öffnen kann.
<P>Dies ist das Ende unserer Tour durch die Erstellung einer KDE 2 Anwendung. Sie können das Quellpaket von KScribble inklusive einer 
Erweiterung, die Ausschneiden, Kopieren, Einfügen und Wiederrufen sowie Drag&amp;Drop Funktionen hinzufügt, hier finden:
<P>
<A HREF="../../../../../apps/kdevelop/examples/kscribble-1.0.tar.gz">$(KDEDIR)/share/apps/kdevelop/examples/kscribble-1.0.tar.gz</A> 
<P>Das Beispieltarball ist lokal installiert und kann in Ihr Homerverzeichnis kopiert werden, wo Sie es auspacken und testen können. 
Nach dem Auspacken mit <CODE>tar zxvf kscribble-1.0.tar.gz</CODE> laden Sie das Projekt und rufen Sie "Automake und Autoconf" aus dem 
"Erstellen" Menü in KDevelop auf. Dann wählen Sie "Configure" aus dem gleichen Menü. Die Konfigurationen sind die meiner 
Installation von KDE 2 und Qt 2.1, Sie müssen sie also an Ihre Installation anpassen.
<P>Der Anhang enthält ebenfalls den kompletten Quellcode für dieses Paket, so daß Sie ihn Online lesen können.
<P>
<P>
<P ALIGN="RIGHT">

<A HREF="index-14.html">Weiter</A>
 <A HREF="index-12.html">Zurück</A>
 <A HREF="index.html#toc13">Inhaltsverzeichnis</A>
</P>
<CENTER>
<HR WIDTH="100%" SIZE=3 ALIGN=CENTER NOSHADE>
</CENTER>    
</FONT>

 
</BODY>
</HTML>
